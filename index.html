<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ITC Token Presale</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="fulllogo_transparent_nobuffer.png">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --main-dark: #0c192d;
      --gold: #d4af37;
      --info-blue: #202d48;
      --success-green: #143d29;
      --error-red: #392126;
      --notif-radius: 12px;
    }
    body { min-height: 100vh; margin: 0; padding: 0;
      background: linear-gradient(180deg, #050d1f 0%, #092048 80%, #153564 100%);
      font-family: 'Inter', 'Montserrat', Arial, sans-serif;
      color: #eaf6fd; overflow-x: hidden; position: relative; }
    .watermark { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      width: 540px; max-width: 100vw; opacity: 0.07; pointer-events: none; user-select: none; z-index: 1;
      filter: blur(1.2px) saturate(0.7);
    }
    .main-container { display: flex; flex-direction: row; justify-content: center;
      align-items: flex-start; gap: 48px; padding: 44px 0 0 0; min-height: 92vh; z-index: 2; position: relative; }
    .left-side { flex: 1.2; max-width: 460px; padding-left: 38px; display: flex; flex-direction: column; align-items: flex-start; gap: 2vh;}
    .logo-header { display: flex; align-items: center; margin-bottom: 27px; }
    .logo-header img { height: 62px; width: 62px; border-radius: 14px; object-fit: contain; background: transparent; padding: 0; border: none; filter: none; box-shadow: none;
      -webkit-mask-image: radial-gradient(circle at 50% 50%, white 83%, transparent 100%);
      mask-image: radial-gradient(circle at 50% 50%, white 83%, transparent 100%);
    }
    .logo-header h1 { font-family: 'Montserrat', 'Inter', Arial, sans-serif; font-size: 2.09rem; font-weight: 700; color: var(--gold); letter-spacing: 0.14em; margin: 0 0 0 19px; padding: 0;}
    .info-card { width: 100%; background: transparent; border: none; box-shadow: none; padding: 22px 0 6px 0; font-size: 1.09rem;}
    .info-card strong, .info-card ul { color: #43e6ff; font-weight: 700;}
    .info-card ul {color: #43e6ff; font-size: 1rem; margin-bottom: 0; margin-top: 10px; padding-left: 24px;}
    .thanks-card { color: #ffc; background: transparent; font-size: 1.06rem; }
    .thanks-card strong, .thanks-card span { color: #43e6ff;}
    .right-side { flex: 1.1; min-width: 340px; display: flex; flex-direction: column; align-items: flex-end; z-index: 2; padding-right: 20px; }
    #presale-widget { width: 370px; border-radius: 18px; background: linear-gradient(135deg, #0a1a35 0%, #1e2d3d 35%, #2d6cf6 100%);
      box-shadow: 0px 4px 16px #111e2b27, 0 1px 3px #00ffe72c;
      padding: 35px 20px 32px 20px; color: #fff; text-align: center; position: relative; z-index: 3; margin: 0;
      border: 1px solid rgba(90,180,255,0.07); backdrop-filter: blur(10px);}
    .input-label { font-size: 16px; color: #a4cfff; text-align:left; margin: 7px 0 4px 0;}
    .buy-row { display: flex; align-items: center; gap: 9px; margin-bottom: 6px; width: 100%; justify-content:center;}
    .buy-row input[type="number"] { width: 45%; padding: 10px; font-size: 1.05rem; border-radius: 10px; border: none; background: #182a47; color: #fafcff;
      transition: border 0.14s; outline: none; text-align:right;}
    .buy-row input[type="number"]:focus { border: 1.3px solid #22c1ff; background: #193869;}
    .after-input-label { font-size: 1rem; color: #44ffd1; margin-bottom: 7px; font-weight:600;}
    button { width: 100%; border-radius: 14px; background: linear-gradient(90deg, #2038a8, #2d6cf6 70%);
      color: #fff; border: none; font-size: 1.09rem; padding: 13px 0; cursor:pointer; font-weight: 700;
      box-shadow: 0 1px 14px 0 #2fc5ff19; transition: background 0.23s; margin-top: 10px;}
    button:disabled { background: #25344f; color: #b3c0df;}
    #walletStatus { min-height: 20px; font-size: 1rem;}
    #notif {
      border-radius: var(--notif-radius);
      align-items: center; margin-top: 14px;
      color:#fff; padding: 7px 9px;
      animation: fadeInNotif .15s;
      display: flex; justify-content: center;
      font-weight: 600; min-height:18px;
      font-size: 1.01em;
      margin-bottom:4px;
    }
    .notif-info { background: var(--info-blue); color: #7ed6fd; }
    .notif-success { background: var(--success-green); color: #60ffac; }
    .notif-error { background: var(--error-red); color: #ffa2a2;}
    @keyframes fadeInNotif { from {opacity:0;} to {opacity:1;} }
    .balance-row { margin-bottom: 7px; font-size: 1.09em; color: #43e6ff;
      display: flex; align-items: center; justify-content: center; font-weight: 600; gap: 7px; letter-spacing:0.06em;}
    .tx-row { margin-top: 7px; font-size:0.97em; display:flex; flex-direction:row; align-items:center; gap:7px; justify-content:center;}
    .tx-hash { color: #fffd7f; background: #232b2f; border-radius: 6px; padding:2px 8px;
      font-family:monospace; letter-spacing:0.05em; font-size:0.98em; cursor: pointer; user-select: all;}
    .copy-btn { border: none; background: #17244f; color: #8ce0fc; border-radius: 4px;
      padding: 3px 8px; cursor: pointer; font-size: 0.97em; margin-left: 2px;}
    .copy-btn:hover { background:#196f82; }
    @media (max-width:1050px) {
      .main-container { flex-direction:column; align-items:center; gap:28px; padding:17px 0 0 0; }
      .left-side, .right-side {padding: 0 4vw; max-width:100vw;}
      .right-side {align-items: center; padding-right:0;}
    }
    @media (max-width:500px) {
      .main-container, #presale-widget { max-width:98vw; padding:11px;}
      .logo-header img { height: 38px; width: 38px;}
      .logo-header h1 { font-size: 1.11rem;}
    }
    #footer-bar {
      margin-top:34px; color:#a3b7d9; font-size: 15px; letter-spacing:0.9px; text-align:center;
      opacity: 0.92; margin-bottom:18px;
    }
  </style>
</head>
<body>
  <img src="fulllogo_transparent_nobuffer.png" class="watermark" alt="IT Capitals Watermark" />
  <div class="main-container">
    <div class="left-side">
      <div class="logo-header">
        <img src="fulllogo_transparent_nobuffer.png" alt="IT Capitals Logo"/>
        <h1>IT CAPITALS</h1>
      </div>
      <div class="info-card">
        <strong>Founded:</strong> February 2025<br>
        IT Capitals specializes in <strong>blockchain development</strong> and <strong>DAPP creation</strong>, IT infrastructure solutions, and advanced website management for clients aiming for digital excellence.
      </div>
      <div class="info-card">
        <strong>Introducing ITC Token:</strong><br>
        A utility token for a next-generation digital rewards and services ecosystem.
        <ul>
          <li>Earn by referring clients or using IT Capitalsâ€™ solutions</li>
          <li>Redeem ITC for premium services & exclusive features</li>
          <li>Soon: Real-world benefitsâ€”partner discounts, events, more</li>
        </ul>
        Join ITC community & unlock unique value in Web3 and IT services.
      </div>
      <div class="info-card thanks-card">
        <strong>With gratitude:</strong><br>
        Special thanks to <span class="highlighted">Mr. MM</span> for visionary ideas and helping build the foundation of IT Capitals.
      </div>
    </div>
    <div class="right-side">
      <div id="presale-widget">
        <div class="balance-row" id="itcBalance" style="display:none;">
          Your ITC Balance: <span id="itcBalanceVal">0</span>
        </div>
        <h2 style="margin-bottom:13px;">ITC Token Presale</h2>
        <div style="font-size:1.09em;color:#43e6ff;font-weight:600;margin-bottom:10px;">Pay with ETH, PYUSD, or T2TO</div>
        <div style="font-size:1em;color:#8ce0fc;margin-bottom:10px;">
          <span style="color:#fff;">1 PYUSD = $1.00 = 2 ITC</span>
        </div>
        <div class="buy-row">
          <span class="input-label" style="margin:0;">Buy</span>
          <input type="number" id="itcInput" min="0" step="1" placeholder="">
          <span class="after-input-label">ITC</span>
        </div>
        <button id="actionBtn">Connect Wallet to buy ITC</button>
        <button id="buyETHBtn" disabled>Buy with ETH</button>
        <button id="buyPYUSDBtn" disabled>Buy with PYUSD</button>
        <button id="buyT2TOBtn" disabled>Buy with T2TO</button>
        <div id="walletStatus" style="min-height:20px;"></div>
        <div id="notif"></div>
        <div class="tx-row" id="txRow" style="display:none;">
          <span>TX Hash:</span>
          <span class="tx-hash" id="txHash"></span>
          <button class="copy-btn" id="copyBtn">Copy</button>
        </div>
      </div>
    </div>
  </div>
  <div id="footer-bar">Powered by IT Capitals, ON, Canada.</div>
<script>
const PRESALE_CONTRACT = "0xd1887abfadc7b5de18c54a547490c8dea792686b";
const PYUSD_ADDRESS = "0xCaC524BcA292aaade2DF8A05cC58F0a65B1B3bB9";
const T2TO_ADDRESS  = "0xDd0C8f1AA8abDb162632F61EdE9b07ffED1eB333";
const ITC_ADDRESS = "0xCb16A849Fb175d857d7DeA1cCfCf7795462F024b";

const presaleAbi = [
  "function getCurrentUSDCPrice() view returns (uint256)",
  "function ethPriceUSDC() view returns (uint256)",
  "function buyWithToken(uint8,uint256) external",
  "function buyWithETH(uint256) external payable",
];
const erc20Abi = [
  "function approve(address,uint256) external returns (bool)",
  "function allowance(address,address) view returns (uint256)",
  "function balanceOf(address) view returns (uint256)"
];
let provider, signer, user, isConnected = false;
const APPROVE_GAS = 80000, BUY_GAS = 200000;

function showNotif(msg, type = "info") {
  const notif = document.getElementById("notif");
  notif.className = "";
  notif.classList.add(type === "success" ? "notif-success" : type === "error" ? "notif-error" : "notif-info");
  notif.textContent = msg;
  notif.style.display = msg.trim() ? "flex" : "none";
  document.getElementById('txRow').style.display = "none";
}
function showTx(txhash) {
  const txRow = document.getElementById('txRow');
  document.getElementById('txHash').textContent = txhash;
  txRow.style.display = "flex";
}
document.getElementById('copyBtn').onclick = function() {
  const hash = document.getElementById('txHash').textContent;
  if (!hash) return;
  navigator.clipboard.writeText(hash);
  showNotif("Copied TX hash!", "success"); 
}
async function showBalance() {
  if (isConnected && window.ethereum && ITC_ADDRESS) {
    try {
      const itc = new ethers.Contract(ITC_ADDRESS, erc20Abi, provider);
      const bal = await itc.balanceOf(user);
      document.getElementById('itcBalanceVal').textContent = (+ethers.utils.formatUnits(bal, 18)).toLocaleString(undefined, {maximumFractionDigits:4});
      document.getElementById('itcBalance').style.display = "flex";
    } catch(e){
      document.getElementById('itcBalance').style.display="none";
    }
  }
}
document.getElementById('actionBtn').onclick = async function() {
  try {
    if (!window.ethereum) return showNotif("MetaMask required!", "error");
    provider = new ethers.providers.Web3Provider(window.ethereum, "any");
    await provider.send("eth_requestAccounts", []);
    signer = provider.getSigner();
    user = await signer.getAddress();
    isConnected = true;
    document.getElementById('actionBtn').textContent = "Wallet Connected";
    document.getElementById("buyETHBtn").disabled = false;
    document.getElementById("buyPYUSDBtn").disabled = false;
    document.getElementById("buyT2TOBtn").disabled = false;
    document.getElementById('walletStatus').innerHTML = `Connected: <span style='color:#6cf;'>${user}</span>`;
    showNotif("Wallet connected! ðŸŽ‰", "success");
    showBalance();
  } catch (err) {
    showNotif("Wallet connect failed: " + (err.message || err), "error");
  }
};
document.getElementById('buyETHBtn').onclick = async function() {
  if (!isConnected) return showNotif("Connect wallet first.", "error");
  const itcAmt = document.getElementById('itcInput').value;
  if (!itcAmt || isNaN(itcAmt) || +itcAmt <= 0) return showNotif("Enter a valid ITC amount.", "error");
  try {
    const contract = new ethers.Contract(PRESALE_CONTRACT, presaleAbi, signer);
    const priceUSDC = await contract.getCurrentUSDCPrice();
    const ethPriceUSDC = await contract.ethPriceUSDC();
    const itcAmountWei = ethers.utils.parseUnits(itcAmt, 18);
    const totalUSDC = ethers.BigNumber.from(priceUSDC).mul(itcAmountWei).div("1000000000000000000");
    const ethRequired = totalUSDC.mul("1000000000000000000").div(ethPriceUSDC);
    const tx = await contract.buyWithETH(itcAmountWei, { value: ethRequired, gasLimit: BUY_GAS });
    showNotif("Sent, awaiting confirmation... â³", "info");
    await tx.wait();
    showNotif("âœ… Bought ITC with ETH!", "success");
    showTx(tx.hash); showBalance();
  } catch (e) {
    showNotif("Error: " + (e && e.message ? e.message : "Unknown"), "error");
    console.error(e);
  }
};
async function buyWithToken(tokenAddr, payTokenEnum, priceUSD, tokenName = "TOKEN") {
  if (!isConnected) return showNotif("Connect wallet first.", "error");
  let itcAmt = document.getElementById('itcInput').value;
  if (!itcAmt || isNaN(itcAmt) || +itcAmt <= 0) return showNotif("Enter a valid ITC amount.", "error");
  let tokensNeeded;
  if (payTokenEnum === 2) {
    tokensNeeded = ethers.utils.parseUnits((+itcAmt/2).toString(), 18);
  } else if (payTokenEnum === 1) {
    tokensNeeded = ethers.utils.parseUnits((+itcAmt).toString(), 18);
  }
  try {
    const token = new ethers.Contract(tokenAddr, erc20Abi, signer);
    const balance = await token.balanceOf(user);
    if (balance.lt(tokensNeeded)) return showNotif(`Not enough ${tokenName} in wallet for this amount.`, "error");
    const allowance = await token.allowance(user, PRESALE_CONTRACT);
    if (allowance.lt(tokensNeeded)) {
      showNotif(`Approve ${tokenName} in MetaMask... ðŸ”„`, "info");
      const tx = await token.approve(PRESALE_CONTRACT, tokensNeeded, { gasLimit: APPROVE_GAS });
      await tx.wait();
      showNotif(`${tokenName} approved! Now submitting buy...`, "info");
    }
    const tx = await (new ethers.Contract(PRESALE_CONTRACT, presaleAbi, signer)).buyWithToken(payTokenEnum, ethers.utils.parseUnits(itcAmt, 18), { gasLimit: BUY_GAS });
    showNotif(`âœ… Bought ITC with ${tokenName}!`, "success");
    showTx(tx.hash); showBalance();
  } catch (e) {
    showNotif("Error: " + (e && e.message ? e.message : "Unknown"), "error");
    console.error(e);
  }
}
document.getElementById('buyPYUSDBtn').onclick = async function() { 
  buyWithToken(PYUSD_ADDRESS, 2, null, "PYUSD");
};
document.getElementById('buyT2TOBtn').onclick = async function() {
  buyWithToken(T2TO_ADDRESS, 1, null, "T2TO");
};
document.getElementById('itcInput').oninput = ()=>showNotif("");
</script>
</body>
</html>
